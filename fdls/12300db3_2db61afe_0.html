<html><head></head>
<body>

<div><br></div><div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">++++++++++++++++++++++++++++++++++Leo++++++++++++++++++++++++++++++++++++++++</span></div><div><span style="font-family: 微软雅黑; font-size: 12pt; font-weight: bold; line-height: 22px; ">项目任务:</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;1. 新建一个Login模块</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;2. 包含验证码，其显示及其刷新、验证</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;3. 用户名密码与数据库中用户名密码匹配</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 31px; ">&nbsp; &nbsp; &nbsp; &nbsp;4. 引用css和js文件，及其存放</span></div><div><br></div><div><span style="font-family: 微软雅黑; font-size: 12pt; font-weight: bold; line-height: 30px; ">验证码：</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 24px; ">&nbsp; &nbsp;1. 先准备ThinkPHP扩展包 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;非php core包中内容，属于扩展包，需下载解压</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 31px; ">&nbsp; &nbsp; &nbsp; &nbsp;ThinkPHP3.1.2_Extend/Extend下的所有内容复制，拷贝到/thinkphp(项目）/ThinkPHP（ThinkPHP核心目录下的Extend文件夹）</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp;2. 生成步骤：</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;a. 在Lib/Action/下新建一个PublicAction.class.php公共模块来生成验证码：</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;class PublicAction extends Action{</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;public function code(){</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 微软雅黑; font-size: 10pt; font-weight: bold; color: rgb(0, 0, 255); line-height: 18px; ">import('ORG.Util.Image');</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Image::buildImageVerify();</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; color: rgb(0, 0, 0); line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 24px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;b. 在模板中文件中调用, 以显示验证码</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 24px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;img</span><span style="font-family: 微软雅黑; font-size: 10pt; font-weight: bold; color: rgb(0, 0, 255); line-height: 24px; ">&nbsp;src="__APP__/Public/code"/</span><span style="font-family: 微软雅黑; font-size: 10pt; color: rgb(0, 0, 0); line-height: 24px; ">&gt;</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;c. 点击验证码图片后刷新功能：</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;img src="__APP__/Public/code"&nbsp;</span><span style="font-family: 微软雅黑; font-size: 10pt; font-weight: bold; line-height: 18px; ">onclick</span><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">='</span><span style="font-family: 微软雅黑; font-size: 10pt; font-weight: bold; line-height: 18px; ">this.src=this.src</span><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">'/&gt;</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//单击后自动刷新，IE中不行，应该采用缓存图片，默认URL不变图片即使用缓存，chrome可以刷新，改为如下</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;img src="__APP__/Public/code" onclick=</span><span style="font-family: 微软雅黑; font-size: 10pt; font-weight: bold; line-height: 18px; ">'this.src=this.src+"?"+Math.random()'</span><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp;/&gt;</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;d. 验证码检查</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$code = $_POST['code'];</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if($_SESSION['verify'] != md5($code)){</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$this-&gt;error('验证码错误');</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 31px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></div><div><span style="font-family: 微软雅黑; font-size: 12pt; font-weight: bold; line-height: 30px; ">用户名密码验证</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp;1. 在数据库中应具备相应用户名密码数据，选择数据库中User表，点击"结构"，添加一个密码字段</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;名字：password</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;类型：char</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;长度：32 &nbsp; &nbsp; &nbsp; &nbsp;（因为MD5加密后往往是固定的32位长度）</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 24px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;再插入数据</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp;2. 密码比对，即在数据库中查找用户名和密码，看是否存在</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;$m = M('user');</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;$where['username'] = $username;</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;$where['password'] = $password;</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;$i = $m-&gt;where($where)-&gt;count();</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;if($i &gt; 0){</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$this-&gt;redirect('User/index');</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;} &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></div><div><br></div><div><span style="font-family: 微软雅黑; font-size: 12pt; font-weight: bold; line-height: 22px; ">其它</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;页面直跳转 $this-&gt;</span><span style="font-family: 微软雅黑; font-size: 10pt; font-weight: bold; color: rgb(255, 0, 0); line-height: 18px; ">redirect</span><span style="font-family: 微软雅黑; font-size: 10pt; color: rgb(0, 0, 0); line-height: 18px; ">('User/index');</span></div><div><span style="font-family: 微软雅黑; font-size: 10pt; line-height: 18px; ">&nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 微软雅黑; font-size: 10pt; font-weight: bold; color: rgb(255, 0, 0); line-height: 18px; ">dump</span><span style="font-family: 微软雅黑; font-size: 10pt; color: rgb(0, 0, 0); line-height: 18px; ">()函数，ThinkPHP自定义的函数，同PHP的var_dump()</span></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div></div><script type="text/javascript" language="javascript" src="jquery.js"></script><script type="text/javascript" language="javascript" src="itemlink.js"></script></body></html>