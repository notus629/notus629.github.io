<html><head></head>
<body>

<div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><b>dedecms 验证码显示背景不显示字母</b></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; 1. 确认 include/data/fonts/ 里面存在字体文件, 默认为 ggbi.ttf</span></div><div><font class="Apple-style-span" face="Consolas"><div><br></div><div><br></div><div><div>&nbsp; &nbsp; 2. 打开验证码生成文件 Include/vdimgck.php,&nbsp;找到</div><div>&nbsp;&nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; for($i=0;$i&lt;$rndcodelen;$i++)</div><div>&nbsp; &nbsp; &nbsp; &nbsp; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $bc = mt_rand(0, 1);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rndstring[$i] = strtoupper($rndstring[$i]);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $c_fontColor = $fontColor[mt_rand(0,4)];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $y_pos = $i==0 ? 4 : $i*($font_size+2);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $c = mt_rand(0, 15);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @imagettftext($im, $font_size, $c, $y_pos, 19, $c_fontColor, $font_file, $rndstring[$i]);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $lastc = $rndstring[$i];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div></div><div><div><br></div><div><br></div><div>&nbsp; &nbsp; 3. 在 for($i=0;$i&lt;$rndcodelen;$i++) 上一行加上如下代码:</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; $font_file = str_replace("\\","/",$font_file);</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; 即把字体文件路径中反斜杠替换成斜杠 因为我们知道反斜杠有转译字符的功能,</div></div><div><br></div><div><br></div><div><br></div><div><b>错误原因：</b></div><div><br></div><div>&nbsp; &nbsp; Imagettftext() 函数没有成功的执行导致了验证码只显示背景，不显示字母。</div><div><br></div><div>&nbsp; &nbsp; 具体原因为：字体文件路径不对.解决方法</div><div><br></div><div>&nbsp; &nbsp; $font_file 路经大体为，盘符:\appserv\www 系统错误的把反斜杠当作转义用了，导致$font_file 也就不是一个路径了。所以 Imagettftext() 函数总是返回错误。加上 $font_file= str_replace("\\","/",$font_file); 即可解决。</div></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><b>References</b></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp;[1]&nbsp;Dede后台验证码不显示解决方法详解(dedecms 5.7) &nbsp;<a href="http://www.jb51.net/cms/68157.html">http://www.jb51.net/cms/68157.html</a></span></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><br></div><script type="text/javascript" language="javascript" src="jquery.js"></script><script type="text/javascript" language="javascript" src="itemlink.js"></script></body></html>