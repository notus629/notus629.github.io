<html><head></head>
<body>

<div><br></div><div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><b><font class="Apple-style-span" face="Consolas">事务处理简单步骤</font></b></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas" color="#ff00ff">&nbsp; &nbsp; try{</font></div><div><font class="Apple-style-span" face="Consolas" style="color: rgb(255, 0, 255); ">&nbsp; &nbsp; &nbsp; &nbsp; </font><span class="Apple-style-span" style="font-family: Consolas; "><font class="Apple-style-span" color="#666699">// 连接</font></span></div><div><font class="Apple-style-span" face="Consolas"><font class="Apple-style-span" color="#ff00ff">&nbsp; &nbsp; &nbsp; &nbsp; $db = &nbsp;new&nbsp;</font><b><font class="Apple-style-span" color="#ff0000">PDO</font></b><font class="Apple-style-span" color="#ff00ff">(...); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></font></div><div><font class="Apple-style-span" face="Consolas" color="#ff00ff">&nbsp; &nbsp; } &nbsp;catch (Exception $error){</font></div><div><font class="Apple-style-span" face="Consolas" style="color: rgb(255, 0, 255); ">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font><span class="Apple-style-span" style="font-family: Consolas; "><font class="Apple-style-span" color="#666699">// 出错</font></span></div><div><font class="Apple-style-span" face="Consolas" color="#ff00ff">&nbsp; &nbsp; &nbsp; &nbsp; die($error-&gt;getMessage()); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><font class="Apple-style-span" face="Consolas" color="#ff00ff">&nbsp; &nbsp; }</font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas" color="#ff00ff">&nbsp; &nbsp; try{</font></div><div><font class="Apple-style-span" face="Consolas" style="color: rgb(255, 0, 255); ">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font><span class="Apple-style-span" style="font-family: Consolas; "><font class="Apple-style-span" color="#666699">//??</font></span></div><div><font class="Apple-style-span" face="Consolas"><font class="Apple-style-span" color="#ff00ff">&nbsp; &nbsp; &nbsp; &nbsp; $db-&gt;</font><b><font class="Apple-style-span" color="#ff6600">setAttribute</font></b><font class="Apple-style-span" color="#ff00ff">(...); &nbsp;</font></font></div><div><font class="Apple-style-span" face="Consolas"><font class="Apple-style-span" color="#ff00ff">&nbsp;&nbsp;</font></font></div><div><font class="Apple-style-span" face="Consolas" style="color: rgb(255, 0, 255); ">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font><span class="Apple-style-span" style="font-family: Consolas; "><font class="Apple-style-span" color="#666699">// 开始事务处理</font></span><span class="Apple-style-span" style="font-family: Consolas; "><font class="Apple-style-span" color="#666699">&nbsp;</font><font class="Apple-style-span" color="#ff00ff"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></span></div><div><font class="Apple-style-span" face="Consolas"><font class="Apple-style-span" color="#ff00ff">&nbsp; &nbsp; &nbsp; &nbsp; $db-&gt;</font><b><font class="Apple-style-span" color="#ff0000">beginTransaction</font></b><font class="Apple-style-span" color="#ff00ff">(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></font></div><div><span class="Apple-style-span" style="font-family: Consolas; "><font class="Apple-style-span" color="#ff00ff"><br></font></span></div><div><span class="Apple-style-span" style="font-family: Consolas; "><font class="Apple-style-span" color="#ff00ff">&nbsp; &nbsp; &nbsp; &nbsp; $db-&gt;</font><b><font class="Apple-style-span" color="#ff6600">exec</font></b><font class="Apple-style-span" color="#ff00ff">($query1); &nbsp; &nbsp;</font></span></div><div><span class="Apple-style-span" style="color: rgb(255, 0, 255); font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; $db-&gt;exec($query2);</span></div><div><font class="Apple-style-span" color="#ff00ff"><font class="Apple-style-span" face="Consolas"><br></font></font></div><div><font class="Apple-style-span" face="Consolas" style="color: rgb(255, 0, 255); ">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font><span class="Apple-style-span" style="font-family: Consolas; "><font class="Apple-style-span" color="#666699">// 事物处理被提交</font></span></div><!--StartFragment--><!--EndFragment--><div><font class="Apple-style-span" face="Consolas"><font class="Apple-style-span" color="#ff00ff">&nbsp; &nbsp; &nbsp; &nbsp; $db-&gt;</font><b><font class="Apple-style-span" color="#ff0000">commit</font></b><font class="Apple-style-span" color="#ff00ff">(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></font></div><div><font class="Apple-style-span" face="Consolas" color="#ff00ff"><br></font></div><div><font class="Apple-style-span" face="Consolas" color="#ff00ff">&nbsp; &nbsp; } catch (Exception $error){</font></div><div><font class="Apple-style-span" face="Consolas" style="color: rgb(255, 0, 255); ">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font><span class="Apple-style-span" style="font-family: Consolas; "><font class="Apple-style-span" color="#666699">// 错误，回滚</font></span></div><div><font class="Apple-style-span" face="Consolas"><font class="Apple-style-span" color="#ff00ff">&nbsp; &nbsp; &nbsp; &nbsp; $db-&gt;</font><b><font class="Apple-style-span" color="#ff6600">roolback</font></b><font class="Apple-style-span" color="#ff00ff">(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></font></div><div><font class="Apple-style-span" face="Consolas" color="#ff00ff">&nbsp; &nbsp; &nbsp; &nbsp; echo "...".$error-&gt;getMessage();</font></div><div><font class="Apple-style-span" face="Consolas" color="#ff00ff">&nbsp; &nbsp; }</font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><script type="text/javascript" language="javascript" src="jquery.js"></script><script type="text/javascript" language="javascript" src="itemlink.js"></script></body></html>