<html><head></head>
<body>

<div><font class="Apple-style-span" face="Consolas"><br></font></div><div><b><font class="Apple-style-span" face="Consolas">mysqli</font></b></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><b>&nbsp; &nbsp; 基本步骤</b></font></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; $db = new <font class="Apple-style-span" color="#ff0000"><b>mysqli</b></font>( 'localhost', 'user_name', 'pwd', 'db_name');</span></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; if(&nbsp;<font class="Apple-style-span" color="#ff0000"><b>mysqli_connect_error</b></font>() ){</span></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; } &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<b>$query </b>= "select * from books where ". $searchtype." <b>like</b> '%".$searchterm."%'";</span></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; $result = $db-&gt;<font class="Apple-style-span" color="#ff0000"><b>query</b></font>($query);</span></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; $num_results = $result-&gt;<b><font class="Apple-style-span" color="#0000ff" style="background-color: rgb(204, 255, 255);">num_rows</font></b>;</span></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;for ($i = 0; $i &lt; $num_results; $i++){</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;$row = $result-&gt;<font class="Apple-style-span" color="#ff0000"><b>fetch_assoc</b></font>(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 以一个相关数组返回结果集每行，属性名为关键字，值为数组中对应的值</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;echo $row['title'];</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;echo $row['author'];</font></div><!--StartFragment--><!--EndFragment--><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;...</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;}</font></div><div><span class="Apple-style-span" style="font-family: Consolas; "><br></span></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$result-&gt;<font class="Apple-style-span" color="#ff0000"><b>free</b></font>()</span></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$db-&gt;<font class="Apple-style-span" color="#ff0000"><b>close</b></font>();</span></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><b>&nbsp; &nbsp; 面向对象语法</b></font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; @ $db = new mysqli( 'localhost', 'user_name', 'pwd', 'db_name');</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $db-&gt;<b><font class="Apple-style-span" color="#ff0000">connect_error</font></b>; &nbsp; &nbsp;&nbsp;</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $db-&gt;<font class="Apple-style-span" color="#ff0000"><b>connect_errno</b></font>; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $db-&gt;select_db(dbname);</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $query = "select * from .............";&nbsp;</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $result &nbsp;= $db-&gt;query($query); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 对于SELECT, SHOW, DESCRIBE or EXPLAIN返回对象，其它成功返回TRUE</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $num_results = $result-&gt;num_rows; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 针对select</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $db-&gt;affected_rows; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 修改数据库时使用</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $row = $result-&gt;fetch_assoc();</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $row = $result-&gt;fetch_row(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 将结果取回到一个列举数组中, 属性值保存在$row[0], $row[1]等</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $row = $result-&gt;fetch_object(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 返回一个对象</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $result-&gt;free(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 释放结果集</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $db-&gt;close(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 关闭数据库连接，非必要，脚本执行完毕会自动关闭</font></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; $db -&gt; connect_errno;</span></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><b><br></b></font></div><div><font class="Apple-style-span" face="Consolas"><b>&nbsp; &nbsp; 面向过程语法</b></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; @ $db = mysqli_connect( 'localhost', 'user_name', 'pwd', 'db_name');</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; mysqli_connect_error();</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; mysqli_connect_errno();</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; mysqli_select_db($db, db_name2);</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $query = "select * from .............";</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $result = mysqli_query($db, $query);</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $num_results = mysqli_num_rows($result);</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<font class="Apple-style-span" color="#ff6600"><b>mysqli_affected_rows</b></font>(...); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 当使用 INSERT, DELETE, UPDATE 修改数据库的查询时使用</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; <font class="Apple-style-span" color="#ff0000"><b>mysqli_fetch_assoc</b></font>(...);</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $row = mysqli_fetch_row($result);</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; mysqli_fetch_array(...); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 获取一行，两种数组都可以</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; $row = mysqli_fetch_object($result); &nbsp; &nbsp; &nbsp; &nbsp; // 以$row-&gt;title, $row-&gt;author等对象的方式访问属性</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; mysqli_free_result($result);</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; mysqli_close($db);</font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><b><font class="Apple-style-span" face="Consolas">使用Prepared语句</font></b></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; 执行大量不同数据的相同查询时，可以提高速度</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; 免受SQL注入攻击</font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; 基本思想：向MySQL发送一个需要执行的<font class="Apple-style-span" color="#ff00ff"><b>查询模板</b></font>，然后再单独发送数据。下次可以不用准备，再次执行</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; 基本过程，如下。</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><blockquote class="webkit-indent-blockquote" style="margin: 0 0 0 40px; border: none; padding: 0px;"><blockquote class="webkit-indent-blockquote" style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><table style="color: rgb(51, 51, 51); font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; "><tbody><tr><td><pre style="margin: 0px; line-height: 16.25px;"><font class="Apple-style-span" face="Consolas" size="2">1
2
3
4
5
6</font></pre></td><td><pre style="margin: 0px; line-height: 16.25px;"><font class="Apple-style-span" face="Consolas" size="2">    <span style="border: 1px solid rgb(255, 0, 0);">$</span>query = <span style="border: 1px solid rgb(255, 0, 0);">'</span><span style="color: rgb(0, 0, 255);">insert</span>  <span style="color: rgb(0, 0, 255);">into</span>  books  <span style="color: rgb(0, 0, 255);">values</span>(?, ?, ?, ?)<span style="color: rgb(163, 21, 21);">";           // 每个数据位置设置问号</span>
<span style="color: rgb(163, 21, 21);">    $stmt = $db-&gt;prepare($query);</span>
<span style="color: rgb(163, 21, 21);">    $stmt-&gt;bind_param("</span>sssd<span style="border: 1px solid rgb(255, 0, 0);">"</span>, <span style="border: 1px solid rgb(255, 0, 0);">$</span>isbn, <span style="border: 1px solid rgb(255, 0, 0);">$</span>author, <span style="border: 1px solid rgb(255, 0, 0);">$</span>title, <span style="border: 1px solid rgb(255, 0, 0);">$</span>price);   // <font class="Apple-style-span" color="#ff0000"><b>'sssd':格式化字符串</b></font>
    <span style="border: 1px solid rgb(255, 0, 0);">$</span>stmt-&gt;execute();
    <span style="border: 1px solid rgb(255, 0, 0);">$</span>echo <span style="border: 1px solid rgb(255, 0, 0);">$</span>stmt-&gt;affected_rows;
    <span style="border: 1px solid rgb(255, 0, 0);">$</span>stmt-&gt;close();</font></pre></td></tr></tbody></table></div></blockquote></blockquote><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; 基本函数：</font></b></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></div><div><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><span class="Apple-style-span" style="font-family: Consolas; ">面向对象版</span></div><div><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><span class="Apple-style-span" style="font-family: Consolas; ">$stmt = $db-&gt;prepare($query);</span></div><div><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><span class="Apple-style-span" style="font-family: Consolas; ">$stmt-&gt;bind_param(....);</span></div><div><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><span class="Apple-style-span" style="font-family: Consolas; ">$stmt-&gt;execute();</span></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><span class="Apple-style-span" style="font-family: Consolas; ">$stmt-&gt;bind_result(...); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 提供希望填充结果列的变量列表</span></div><div><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><span class="Apple-style-span" style="font-family: Consolas; ">$stmt-&gt;execute(...); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 执行之后可以循环调用fetch</span></div><div><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><b><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp;&nbsp;</font></b><span class="Apple-style-span" style="font-family: Consolas; ">$stmt-&gt;fetch(...); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 结果集的下一行的列值被填充到这些绑定变量(bind_result中绑定的)中&nbsp;</span></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; 面向过程版</font></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mysqli_stmt_prepare(...); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (stmt: statement?)</span></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or mysqli_prepare(...); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mysqli_stmt_bind_param();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or mysqli_bind_param; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;// DEPRECATED as of PHP 5.3.0 and REMOVED as of PHP 5.4.0.</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mysqli_stmt_execute();</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or mysqli_execute(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp;is deprecated and will be removed.</font></div><div><span class="Apple-style-span" style="font-family: Consolas; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mysqli_stmt_bind_result(...);</span></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mysqli_stmt_fetch();</font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" face="Consolas"><br></font></div><div><font class="Apple-style-span" size="4"><br></font></div><script type="text/javascript" language="javascript" src="jquery.js"></script><script type="text/javascript" language="javascript" src="itemlink.js"></script></body></html>